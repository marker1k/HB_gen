<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="lib/codemirror.css">
  <script src="lib/codemirror.js"></script>
  <script src="mode/xml/xml.js"></script>
  <script src="mode/javascript/javascript.js"></script>
  <script src="mode/css/css.js"></script>
  <script src="mode/vbscript/vbscript.js"></script>
  <script src="mode/htmlmixed/htmlmixed.js"></script>
  <script src="clipboard.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Yandex HB Config Generator</title>
  <link rel="stylesheet" href="style.css">
  <script src="conf.js"></script>
</head>

<body>
  <div class="header">Header Bidding Config</div>
  <div id="mainError">ERROR</div>
  <div class="form">
    <div id="biddersMap">
      <h3>Bidders Map</h3>
      <div id="biddersMapInner"></div>
      <button id="addBiddersMapUiElement" onclick="biddersMap.addBiddersMapUiElement(this);">Добавить</button>
    </div>
    <br>
    <hr>
    <div id="adUnits">
      <h3>Ad Units</h3>
      <div id="adUnitsInner"></div>
      <button id="addAdUnitsUiElement" onclick="AdUnits.addAdUnitsUiElement(this);">Добавить</button>
      <button style="margin-left: 235px;" class="generate" onclick="">Генерация</button>
    </div>
    <br>
    <hr>
    <h3>User Timeout</h3>
    <p style="font-size: 15px">Время ожидания ответа от сервера покупателя, рекомендуемое время 500 мс (максимально возможное 3000 мс)</p>
    <input id="userTimeout" placeholder="500" value="500" oninput="timeoutInput.checkTimeout(this);">
    <div class="" id="timeoutError">
      sdsdfsdf
    </div>
  </div>
  <div class="container">
    <div id="result">
      <h3>Result</h3>
      <div>
      <input type="checkbox" id="as" name="as" value="as" /><label for="claws">Асинхронный loader.js</label></div>
      <button class="generate" id="generate" onclick="">Генерация</button>
      <button class="copyToClipboard" onclick="main.showSuccess()">Copy</button>
      <span class="error" id="generateError">Заполните все поля</span>
      <br>
      <form>
        <textarea id="result_textarea" disabled="disabled"></textarea>
      </form>
    </div>
  </div>
  <div id="timeoutError">ID контейнеров должны быть уникальными</div>
  <div id="sizesError">ID контейнеров должны быть уникальными</div>
  <div id="generateError">ID контейнеров должны быть уникальными</div>
  <div id="sameContainer">ID контейнеров должны быть уникальными</div>
  <div id="fillAdUnits">ID контейнеров должны быть уникальными</div>
  <div id="wrongLetters">ID контейнеров должны быть уникальными</div>
  <script type="text/javascript">
    var editorSelector = '#result_textarea';
    new ClipboardJS('.copyToClipboard', {
      text: function(trigger) {
        return getCodeMirrorNative(editorSelector).getDoc().getValue();
      }
    });

    function getCodeMirrorNative(target) {
      var _target = target;
      if (typeof _target === 'string') {
        _target = document.querySelector(_target);
      }
      if (_target === null || !_target.tagName === undefined) {
        throw new Error('Element does not reference a CodeMirror instance.');
      }

      if (_target.className.indexOf('CodeMirror') > -1) {
        return _target.CodeMirror;
      }

      if (_target.tagName === 'TEXTAREA') {
        return _target.nextSibling.CodeMirror;
      }

      return null;
    };
    var generateButtons = document.getElementsByClassName("generate");
    for (var i = 0; i < generateButtons.length; i += 1) {
      generateButtons[i].addEventListener('click', function() {
        main.makeInstall();
      });
      generateButtons[i].disabled = true;
    }
  </script>
</body>

</html>
